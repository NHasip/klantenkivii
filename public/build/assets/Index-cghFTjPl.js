import{u as k,r as b,a as w,j as s,H as _,L as C,b as L}from"./app-DpfuxhY8.js";import{u as T,i as E,a as S,b as A,E as O}from"./index-OoBmQk1y.js";import"./module.esm-CDoHWUqT.js";function f(...a){return a.filter(Boolean).join(" ")}function r({active:a,disabled:o,onClick:d,children:h,title:l}){return s.jsx("button",{type:"button",title:l,onClick:d,disabled:o,className:f("rounded-md px-2 py-1 text-xs font-semibold transition",a?"bg-zinc-900 text-white":"text-zinc-700 hover:bg-zinc-100",o&&"cursor-not-allowed opacity-40"),children:h})}function B({templates:a,variables:o,urls:d}){var g;const h=k(),[l,m]=b.useState(((g=a==null?void 0:a[0])==null?void 0:g.id)??"new"),n=b.useMemo(()=>a.find(t=>t.id===l),[a,l]),x=l==="new",i=w({name:"",subject:"",body_html:"",is_active:!0});b.useEffect(()=>{n?i.setData({name:n.name||"",subject:n.subject||"",body_html:n.body_html||"",is_active:!!n.is_active}):x&&i.setData({name:"",subject:"",body_html:"<p></p>",is_active:!0})},[n==null?void 0:n.id,x]);const e=T({extensions:[E.configure({heading:{levels:[2,3]}}),S.configure({openOnClick:!1,autolink:!0,defaultProtocol:"https"}),A.configure({placeholder:"Schrijf je e-mail template..."})],content:i.data.body_html||"<p></p>",onUpdate:({editor:t})=>{i.setData("body_html",t.getHTML())}});b.useEffect(()=>{var c;if(!e)return;const t=(c=i.data.body_html)!=null&&c.trim()?i.data.body_html:"<p></p>";e.getHTML()!==t&&e.commands.setContent(t,!1)},[e,i.data.body_html]);const j=(t,c,u={})=>{const z=e?e.getHTML():i.data.body_html;i.transform(p=>({...p,body_html:z})).submit(t,c,{preserveScroll:!0,...u,onSuccess:(...p)=>{var v;L.reload({only:["templates"],preserveScroll:!0,preserveState:!0}),(v=u.onSuccess)==null||v.call(u,...p)}})},N=t=>{var c;(c=t==null?void 0:t.preventDefault)==null||c.call(t),x?j("post",d.store,{onSuccess:()=>m("new")}):n&&j("patch",d.update.replace("__TEMPLATE__",n.id))},y=async()=>{!n||n.is_system||!await h({title:"Template verwijderen",message:`Weet je zeker dat je "${n.name}" wilt verwijderen?`,confirmText:"Verwijderen",cancelText:"Annuleren",tone:"danger"})||i.delete(d.delete.replace("__TEMPLATE__",n.id),{preserveScroll:!0,onSuccess:()=>m("new")})};return s.jsxs("div",{className:"space-y-6",children:[s.jsx(_,{title:"E-mail templates"}),s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-semibold text-zinc-900",children:"E-mail templates"}),s.jsx("p",{className:"mt-1 text-sm text-zinc-500",children:"Beheer je e-mail templates en gebruik variabelen voor persoonlijke velden."})]}),s.jsx(C,{href:d.back||"/dashboard",className:"rounded-md border border-zinc-200 px-3 py-2 text-sm font-semibold hover:bg-zinc-50",children:"Terug"})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-12",children:[s.jsxs("div",{className:"space-y-3 lg:col-span-4",children:[s.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"text-sm font-semibold",children:"Templates"}),s.jsx("button",{type:"button",className:"rounded-full border border-zinc-200 px-3 py-1 text-xs font-semibold hover:bg-zinc-50",onClick:()=>m("new"),children:"Nieuw"})]}),s.jsxs("div",{className:"mt-3 space-y-2",children:[a.length===0&&s.jsx("div",{className:"text-xs text-zinc-500",children:"Nog geen templates."}),a.map(t=>s.jsxs("button",{type:"button",onClick:()=>m(t.id),className:f("w-full rounded-lg border px-3 py-2 text-left transition",l===t.id?"border-zinc-900 bg-zinc-900 text-white":"border-zinc-200 bg-white text-zinc-700 hover:bg-zinc-50"),children:[s.jsx("div",{className:"text-sm font-semibold",children:t.name}),s.jsx("div",{className:f("mt-1 text-xs",l===t.id?"text-zinc-200":"text-zinc-500"),children:t.subject||"Geen onderwerp"})]},t.id))]})]}),s.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-4",children:[s.jsx("div",{className:"text-xs font-semibold text-zinc-500",children:"Beschikbare velden"}),s.jsx("div",{className:"mt-2 space-y-1 text-xs text-zinc-600",children:Object.keys(o||{}).map(t=>s.jsx("div",{className:"rounded-md border border-zinc-200 bg-zinc-50 px-2 py-1 font-mono",children:`{{ ${t} }}`},t))})]})]}),s.jsx("div",{className:"space-y-4 lg:col-span-8",children:s.jsxs("form",{onSubmit:N,className:"space-y-4",children:[s.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-4",children:[s.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold text-zinc-500",children:"Naam"}),s.jsx("input",{className:"mt-2 w-full rounded-md border-zinc-300 text-sm",value:i.data.name,onChange:t=>i.setData("name",t.target.value)}),i.errors.name&&s.jsx("div",{className:"mt-1 text-xs text-rose-600",children:i.errors.name})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold text-zinc-500",children:"Onderwerp"}),s.jsx("input",{className:"mt-2 w-full rounded-md border-zinc-300 text-sm",value:i.data.subject,onChange:t=>i.setData("subject",t.target.value)}),i.errors.subject&&s.jsx("div",{className:"mt-1 text-xs text-rose-600",children:i.errors.subject})]})]}),s.jsxs("label",{className:"mt-4 flex items-center gap-2 text-xs font-semibold text-zinc-600",children:[s.jsx("input",{type:"checkbox",className:"rounded border-zinc-300",checked:!!i.data.is_active,onChange:t=>i.setData("is_active",t.target.checked)}),"Actief"]})]}),s.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-4",children:[s.jsx("div",{className:"text-xs font-semibold text-zinc-500",children:"Template inhoud"}),s.jsxs("div",{className:"mt-2 rounded-lg border border-zinc-200",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-1 border-b border-zinc-100 bg-zinc-50 px-2 py-2",children:[s.jsx(r,{title:"Vet",active:e==null?void 0:e.isActive("bold"),disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().toggleBold().run(),children:"Vet"}),s.jsx(r,{title:"Cursief",active:e==null?void 0:e.isActive("italic"),disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().toggleItalic().run(),children:"Cursief"}),s.jsx(r,{title:"Opsomming",active:e==null?void 0:e.isActive("bulletList"),disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().toggleBulletList().run(),children:"Lijst"}),s.jsx(r,{title:"Genummerde lijst",active:e==null?void 0:e.isActive("orderedList"),disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().toggleOrderedList().run(),children:"Nummering"}),s.jsx(r,{title:"Link",active:e==null?void 0:e.isActive("link"),disabled:!e,onClick:()=>{if(!e)return;const t=e.getAttributes("link").href||"",c=window.prompt("Link URL",t);if(c!==null){if(c===""){e.chain().focus().unsetLink().run();return}e.chain().focus().extendMarkRange("link").setLink({href:c}).run()}},children:"Link"}),s.jsx(r,{title:"Opmaak wissen",disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().clearNodes().unsetAllMarks().run(),children:"Wissen"}),s.jsx(r,{title:"Ongedaan maken",disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().undo().run(),children:"Undo"}),s.jsx(r,{title:"Opnieuw",disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().redo().run(),children:"Redo"})]}),s.jsx(O,{editor:e,className:"tiptap px-3 py-2 text-sm"})]})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("button",{type:"submit",className:"rounded-md bg-zinc-900 px-3 py-2 text-sm font-semibold text-white hover:bg-zinc-800 disabled:opacity-60",disabled:i.processing,children:i.processing?"Opslaan...":"Opslaan"}),!x&&n&&!n.is_system&&s.jsx("button",{type:"button",className:"rounded-md border border-rose-200 px-3 py-2 text-sm font-semibold text-rose-600 hover:bg-rose-50",onClick:y,children:"Verwijderen"})]})]})})]})]})}export{B as default};
