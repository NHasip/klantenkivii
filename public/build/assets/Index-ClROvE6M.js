import{u as L,r as b,a as T,j as s,H as E,L as S,b as A}from"./app-qolBc89A.js";import{u as M,i as O,a as D,b as H,E as U}from"./index-Bs0UYknV.js";import"./module.esm-CDoHWUqT.js";function h(...a){return a.filter(Boolean).join(" ")}function l({active:a,disabled:u,onClick:r,children:p,title:d}){return s.jsx("button",{type:"button",title:d,onClick:r,disabled:u,className:h("rounded-md px-2 py-1 text-xs font-semibold transition",a?"bg-zinc-900 text-white":"text-zinc-700 hover:bg-zinc-100",u&&"cursor-not-allowed opacity-40"),children:p})}function V({templates:a,variables:u,urls:r}){var N;const p=L(),[d,x]=b.useState(((N=a==null?void 0:a[0])==null?void 0:N.id)??"new"),i=b.useMemo(()=>a.find(t=>t.id===d),[a,d]),o=d==="new",z=!o&&i&&!i.is_system,f=r.update_post||r.update,j=r.delete_post||r.delete,n=T({name:"",subject:"",body_html:"",is_active:!0});b.useEffect(()=>{i?n.setData({name:i.name||"",subject:i.subject||"",body_html:i.body_html||"",is_active:!!i.is_active}):o&&n.setData({name:"",subject:"",body_html:"<p></p>",is_active:!0})},[i==null?void 0:i.id,o]);const e=M({extensions:[O.configure({heading:{levels:[2,3]}}),D.configure({openOnClick:!1,autolink:!0,defaultProtocol:"https"}),H.configure({placeholder:"Schrijf je e-mail template..."})],content:n.data.body_html||"<p></p>",onUpdate:({editor:t})=>{n.setData("body_html",t.getHTML())}});b.useEffect(()=>{var c;if(!e)return;const t=(c=n.data.body_html)!=null&&c.trim()?n.data.body_html:"<p></p>";e.getHTML()!==t&&e.commands.setContent(t,!1)},[e,n.data.body_html]);const g=(t,c,m={})=>{const w=e?e.getHTML():n.data.body_html,k={...n.data,body_html:w};(t==="post"?n.post:t==="patch"?n.patch:n.post)(c,{preserveScroll:!0,...m,data:k,onSuccess:(...C)=>{var y;A.reload({only:["templates"],preserveScroll:!0,preserveState:!0}),(y=m.onSuccess)==null||y.call(m,...C)}})},v=t=>{var c;if((c=t==null?void 0:t.preventDefault)==null||c.call(t),o){g("post",r.store,{onSuccess:()=>x("new")});return}if(i){const m=f.replace("__TEMPLATE__",i.id);g(f?"post":"patch",m)}},_=async()=>{if(!(!i||i.is_system||!await p({title:"Template verwijderen",message:`Weet je zeker dat je "${i.name}" wilt verwijderen?`,confirmText:"Verwijderen",cancelText:"Annuleren",tone:"danger"}))){if(j){n.post(j.replace("__TEMPLATE__",i.id),{preserveScroll:!0,onSuccess:()=>x("new")});return}n.delete(r.delete.replace("__TEMPLATE__",i.id),{preserveScroll:!0,onSuccess:()=>x("new")})}};return s.jsxs("div",{className:"space-y-6",children:[s.jsx(E,{title:"E-mail templates"}),s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-semibold text-zinc-900",children:"E-mail templates"}),s.jsx("p",{className:"mt-1 text-sm text-zinc-500",children:"Beheer je e-mail templates en gebruik variabelen voor persoonlijke velden."})]}),s.jsx(S,{href:r.back||"/dashboard",className:"rounded-md border border-zinc-200 px-3 py-2 text-sm font-semibold hover:bg-zinc-50",children:"Terug"})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-12",children:[s.jsxs("div",{className:"space-y-3 lg:col-span-4",children:[s.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"text-sm font-semibold",children:"Templates"}),s.jsx("button",{type:"button",className:"rounded-full border border-zinc-200 px-3 py-1 text-xs font-semibold hover:bg-zinc-50",onClick:()=>x("new"),children:"Nieuw"})]}),s.jsxs("div",{className:"mt-3 space-y-2",children:[a.length===0&&s.jsx("div",{className:"text-xs text-zinc-500",children:"Nog geen templates."}),a.map(t=>s.jsxs("button",{type:"button",onClick:()=>x(t.id),className:h("w-full rounded-lg border px-3 py-2 text-left transition",d===t.id?"border-zinc-900 bg-zinc-900 text-white":"border-zinc-200 bg-white text-zinc-700 hover:bg-zinc-50"),children:[s.jsx("div",{className:"text-sm font-semibold",children:t.name}),s.jsx("div",{className:h("mt-1 text-xs",d===t.id?"text-zinc-200":"text-zinc-500"),children:t.subject||"Geen onderwerp"})]},t.id))]})]}),s.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-4",children:[s.jsx("div",{className:"text-xs font-semibold text-zinc-500",children:"Beschikbare velden"}),s.jsx("div",{className:"mt-2 space-y-1 text-xs text-zinc-600",children:Object.keys(u||{}).map(t=>s.jsx("div",{className:"rounded-md border border-zinc-200 bg-zinc-50 px-2 py-1 font-mono",children:`{{ ${t} }}`},t))})]})]}),s.jsx("div",{className:"space-y-4 lg:col-span-8",children:s.jsxs("form",{onSubmit:v,className:"space-y-4",children:[s.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-4",children:[s.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold text-zinc-500",children:"Naam"}),s.jsx("input",{className:"mt-2 w-full rounded-md border-zinc-300 text-sm",value:n.data.name,onChange:t=>n.setData("name",t.target.value)}),n.errors.name&&s.jsx("div",{className:"mt-1 text-xs text-rose-600",children:n.errors.name})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold text-zinc-500",children:"Onderwerp"}),s.jsx("input",{className:"mt-2 w-full rounded-md border-zinc-300 text-sm",value:n.data.subject,onChange:t=>n.setData("subject",t.target.value)}),n.errors.subject&&s.jsx("div",{className:"mt-1 text-xs text-rose-600",children:n.errors.subject})]})]}),s.jsxs("label",{className:"mt-4 flex items-center gap-2 text-xs font-semibold text-zinc-600",children:[s.jsx("input",{type:"checkbox",className:"rounded border-zinc-300",checked:!!n.data.is_active,onChange:t=>n.setData("is_active",t.target.checked)}),"Actief"]})]}),s.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-4",children:[s.jsx("div",{className:"text-xs font-semibold text-zinc-500",children:"Template inhoud"}),s.jsxs("div",{className:"mt-2 rounded-lg border border-zinc-200",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-1 border-b border-zinc-100 bg-zinc-50 px-2 py-2",children:[s.jsx(l,{title:"Vet",active:e==null?void 0:e.isActive("bold"),disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().toggleBold().run(),children:"Vet"}),s.jsx(l,{title:"Cursief",active:e==null?void 0:e.isActive("italic"),disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().toggleItalic().run(),children:"Cursief"}),s.jsx(l,{title:"Opsomming",active:e==null?void 0:e.isActive("bulletList"),disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().toggleBulletList().run(),children:"Lijst"}),s.jsx(l,{title:"Genummerde lijst",active:e==null?void 0:e.isActive("orderedList"),disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().toggleOrderedList().run(),children:"Nummering"}),s.jsx(l,{title:"Link",active:e==null?void 0:e.isActive("link"),disabled:!e,onClick:()=>{if(!e)return;const t=e.getAttributes("link").href||"",c=window.prompt("Link URL",t);if(c!==null){if(c===""){e.chain().focus().unsetLink().run();return}e.chain().focus().extendMarkRange("link").setLink({href:c}).run()}},children:"Link"}),s.jsx(l,{title:"Opmaak wissen",disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().clearNodes().unsetAllMarks().run(),children:"Wissen"}),s.jsx(l,{title:"Ongedaan maken",disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().undo().run(),children:"Undo"}),s.jsx(l,{title:"Opnieuw",disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().redo().run(),children:"Redo"})]}),s.jsx(U,{editor:e,className:"tiptap px-3 py-2 text-sm"})]})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("button",{type:"button",className:"rounded-md bg-zinc-900 px-3 py-2 text-sm font-semibold text-white hover:bg-zinc-800 disabled:opacity-60",disabled:n.processing,onClick:v,children:n.processing?"Opslaan...":"Opslaan"}),!o&&i&&s.jsx("button",{type:"button",className:h("rounded-md border px-3 py-2 text-sm font-semibold",i.is_system?"cursor-not-allowed border-zinc-200 text-zinc-400":"border-rose-200 text-rose-600 hover:bg-rose-50"),onClick:_,disabled:i.is_system,children:"Verwijderen"}),!z&&!o&&i&&i.is_system&&s.jsx("div",{className:"text-xs text-zinc-500",children:"Standaard templates kun je niet verwijderen."})]})]})})]})]})}export{V as default};
