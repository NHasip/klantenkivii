import{r as N,u as C,j as e,H as R,L as z}from"./app-pn7A5jb7.js";import"./app-Da9Q4cYH.js";function j(d){try{return new Intl.NumberFormat("nl-NL",{style:"currency",currency:"EUR"}).format(d??0)}catch{return`EUR ${Number(d??0).toFixed(2)}`.replace(".",",")}}function _(d){const r=Number(String(d).replace(",","."));return Number.isFinite(r)?r:0}function M(d){const r=a=>String(a).padStart(2,"0"),x=d.getFullYear(),o=r(d.getMonth()+1),i=r(d.getDate()),b=r(d.getHours()),p=r(d.getMinutes());return`${x}-${o}-${i}T${b}:${p}`}function $(d=12){const r="ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz23456789!@#$%",x=new Uint32Array(d),o=[];if(window.crypto&&window.crypto.getRandomValues){window.crypto.getRandomValues(x);for(let i=0;i<d;i+=1)o.push(r[x[i]%r.length])}else for(let i=0;i<d;i+=1)o.push(r[Math.floor(Math.random()*r.length)]);return o.join("")}function P({statusOptions:d,sourceOptions:r,moduleRows:x,defaults:o,urls:i}){const[b,p]=N.useState(!1),{data:a,setData:l,post:w,processing:g,errors:s}=C({bedrijfsnaam:"",kvk_nummer:"",land:o.land||"Nederland",voor_en_achternaam:"",email:"",telefoonnummer:"",straatnaam_en_nummer:"",postcode:"",plaats:"",iban:"",bic:"",plaats_van_tekenen:"",datum_van_tekenen:o.datum_van_tekenen||"",status:(d==null?void 0:d[0])||"lead",bron:(r==null?void 0:r[0])||"website_formulier",tags:"",proefperiode_start:o.proefperiode_start||M(new Date),actief_vanaf:"",opgezegd_op:"",opzegreden:"",login_email:"",login_password:"",moduleRows:x||[]}),u=N.useMemo(()=>{let t=0,n=0,c=0;return a.moduleRows.forEach(m=>{if(!m.actief)return;const v=_(m.prijs_maand_excl),f=Math.max(1,Number(m.aantal||1));t+=v*f,n+=v*f*(_(m.btw_percentage)/100),c+=1}),{totaleModules:a.moduleRows.length,actieveModules:c,totaalExcl:t,btw:n,totaalIncl:t+n}},[a.moduleRows]),h=(t,n,c)=>{l("moduleRows",a.moduleRows.map((m,v)=>v===t?{...m,[n]:c}:m))},k=t=>{const n=a.moduleRows[t];h(t,"actief",!n.actief),!n.actief&&Number(n.aantal||0)<1&&h(t,"aantal",1)},y=t=>{t.preventDefault(),w(i.store,{preserveScroll:!0})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(R,{title:"Nieuwe klant"}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-zinc-900",children:"Nieuwe klant"}),e.jsx("p",{className:"mt-1 text-sm text-zinc-500",children:"Maak een garagebedrijf aan met modules en incasso."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{href:i.index,className:"rounded-md border border-zinc-200 px-3 py-2 text-sm font-semibold hover:bg-zinc-50",children:"Terug"}),e.jsx(z,{href:i.old_create,className:"rounded-md border border-zinc-200 px-3 py-2 text-sm font-semibold text-zinc-500 hover:bg-zinc-50",children:"Nieuw (old)"})]})]}),e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-5",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Bedrijf"}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Bedrijfsnaam *"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.bedrijfsnaam,onChange:t=>l("bedrijfsnaam",t.target.value)}),s.bedrijfsnaam&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s.bedrijfsnaam})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"KVK nummer"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.kvk_nummer,onChange:t=>l("kvk_nummer",t.target.value)}),s.kvk_nummer&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s.kvk_nummer})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Land *"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.land,onChange:t=>l("land",t.target.value)})]})]})]}),e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-5",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Contactpersoon"}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Voor- en achternaam *"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.voor_en_achternaam,onChange:t=>l("voor_en_achternaam",t.target.value)}),s.voor_en_achternaam&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s.voor_en_achternaam})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"E-mail *"}),e.jsx("input",{type:"email",className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.email,onChange:t=>l("email",t.target.value)}),s.email&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Telefoon *"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.telefoonnummer,onChange:t=>l("telefoonnummer",t.target.value)}),s.telefoonnummer&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s.telefoonnummer})]})]})]}),e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-5",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Adres"}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Straat + nummer *"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.straatnaam_en_nummer,onChange:t=>l("straatnaam_en_nummer",t.target.value)}),s.straatnaam_en_nummer&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s.straatnaam_en_nummer})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Postcode *"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.postcode,onChange:t=>l("postcode",t.target.value)}),s.postcode&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s.postcode})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Plaats *"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.plaats,onChange:t=>l("plaats",t.target.value)}),s.plaats&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s.plaats})]})]})]}),e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-5",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Incasso (SEPA)"}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"IBAN"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.iban,onChange:t=>l("iban",t.target.value)}),s.iban&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s.iban})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"BIC"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.bic,onChange:t=>l("bic",t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Plaats van tekenen"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.plaats_van_tekenen,onChange:t=>l("plaats_van_tekenen",t.target.value)}),s.plaats_van_tekenen&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s.plaats_van_tekenen})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Datum van tekenen"}),e.jsx("input",{type:"date",className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.datum_van_tekenen,onChange:t=>l("datum_van_tekenen",t.target.value)}),s.datum_van_tekenen&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s.datum_van_tekenen})]})]})]}),e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-5",children:[e.jsx("div",{className:"text-sm font-semibold",children:"CRM"}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Status"}),e.jsx("select",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.status,onChange:t=>l("status",t.target.value),children:d.map(t=>e.jsx("option",{value:t,children:t},t))}),s.status&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s.status})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Proefperiode start"}),e.jsx("input",{type:"datetime-local",className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.proefperiode_start,onChange:t=>l("proefperiode_start",t.target.value)}),s.proefperiode_start&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s.proefperiode_start})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Actief vanaf"}),e.jsx("input",{type:"datetime-local",className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.actief_vanaf,onChange:t=>l("actief_vanaf",t.target.value)}),s.actief_vanaf&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s.actief_vanaf})]}),a.status==="opgezegd"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Opgezegd op"}),e.jsx("input",{type:"datetime-local",className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.opgezegd_op,onChange:t=>l("opgezegd_op",t.target.value)}),s.opgezegd_op&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s.opgezegd_op})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Opzegreden"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.opzegreden,onChange:t=>l("opzegreden",t.target.value)}),s.opzegreden&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s.opzegreden})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Bron"}),e.jsx("select",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.bron,onChange:t=>l("bron",t.target.value),children:r.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Tags"}),e.jsx("textarea",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",rows:2,value:a.tags,onChange:t=>l("tags",t.target.value)})]})]})]}),e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-5",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Login gegevens"}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Login e-mail"}),e.jsx("input",{type:"email",className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.login_email,onChange:t=>l("login_email",t.target.value)}),s.login_email&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s.login_email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Wachtwoord"}),e.jsxs("div",{className:"mt-1 flex gap-2",children:[e.jsx("input",{type:b?"text":"password",className:"w-full rounded-md border-zinc-300 text-sm",value:a.login_password,onChange:t=>l("login_password",t.target.value)}),e.jsx("button",{type:"button",className:"rounded-md border border-zinc-200 px-3 text-xs font-semibold hover:bg-zinc-50",onClick:()=>p(t=>!t),children:b?"Verberg":"Toon"}),e.jsx("button",{type:"button",className:"rounded-md border border-zinc-200 px-3 text-xs font-semibold hover:bg-zinc-50",onClick:()=>{l("login_password",$()),p(!0)},children:"Genereer"})]}),s.login_password&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s.login_password})]}),e.jsx("div",{className:"sm:col-span-2 text-xs text-zinc-500",children:"Laat leeg als je nog geen account wilt aanmaken. Vul beide velden in om een login te creëren."})]})]}),e.jsxs("div",{className:"space-y-4 rounded-xl border border-zinc-200 bg-white p-5",children:[e.jsx("div",{className:"flex flex-wrap items-center justify-between gap-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold",children:"Modules & prijzen"}),e.jsxs("div",{className:"mt-1 text-xs text-zinc-500",children:["Activeer modules en leg prijsafspraken vast per maand. Actief: ",u.actieveModules," /"," ",u.totaleModules,". Actief vereist aantal ≥ 1. Prijs 0 is toegestaan."]})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-zinc-50 p-4",children:[e.jsx("div",{className:"text-xs font-medium text-zinc-500",children:"Totaal excl. btw"}),e.jsx("div",{className:"mt-1 text-xl font-semibold",children:j(u.totaalExcl)})]}),e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-zinc-50 p-4",children:[e.jsx("div",{className:"text-xs font-medium text-zinc-500",children:"BTW bedrag"}),e.jsx("div",{className:"mt-1 text-xl font-semibold",children:j(u.btw)})]}),e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-zinc-50 p-4",children:[e.jsx("div",{className:"text-xs font-medium text-zinc-500",children:"Totaal incl. btw"}),e.jsx("div",{className:"mt-1 text-xl font-semibold",children:j(u.totaalIncl)})]})]}),e.jsx("div",{className:"overflow-hidden rounded-xl border border-zinc-200 bg-white",children:e.jsxs("table",{className:"min-w-full divide-y divide-zinc-100",children:[e.jsx("thead",{className:"bg-zinc-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-zinc-600",children:"Actief"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-zinc-600",children:"Module"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-zinc-600",children:"Aantal"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-zinc-600",children:"Prijs (excl.)"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-zinc-600",children:"BTW %"})]})}),e.jsx("tbody",{className:"divide-y divide-zinc-100",children:a.moduleRows.map((t,n)=>e.jsxs("tr",{className:"hover:bg-zinc-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"checkbox",className:"rounded border-zinc-300",checked:t.actief,onChange:()=>k(n)})}),e.jsx("td",{className:"px-4 py-3 text-sm font-semibold",children:t.naam}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("input",{type:"number",min:"0",max:"999",className:"w-24 rounded-md border-zinc-300 text-sm",value:t.aantal,onChange:c=>h(n,"aantal",c.target.value)}),s[`moduleRows.${n}.aantal`]&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s[`moduleRows.${n}.aantal`]})]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("input",{type:"number",step:"0.01",min:"0",className:"w-40 rounded-md border-zinc-300 text-sm",value:t.prijs_maand_excl,onChange:c=>h(n,"prijs_maand_excl",c.target.value)}),s[`moduleRows.${n}.prijs_maand_excl`]&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s[`moduleRows.${n}.prijs_maand_excl`]})]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",className:"w-24 rounded-md border-zinc-300 text-sm",value:t.btw_percentage,onChange:c=>h(n,"btw_percentage",c.target.value)}),s[`moduleRows.${n}.btw_percentage`]&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:s[`moduleRows.${n}.btw_percentage`]})]})]},t.module_id))})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",className:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white hover:bg-indigo-700",disabled:g,children:g?"Opslaan...":"Klant opslaan"})})]})]})}export{P as default};
