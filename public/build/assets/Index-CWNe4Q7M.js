import{u as C,r as b,a as L,j as s,H as T,L as E,b as S}from"./app-CCaMfiPV.js";import{u as A,i as O,a as M,b as D,E as H}from"./index-BBRI_Ruf.js";import"./module.esm-CDoHWUqT.js";function f(...c){return c.filter(Boolean).join(" ")}function r({active:c,disabled:x,onClick:l,children:h,title:d}){return s.jsx("button",{type:"button",title:d,onClick:l,disabled:x,className:f("rounded-md px-2 py-1 text-xs font-semibold transition",c?"bg-zinc-900 text-white":"text-zinc-700 hover:bg-zinc-100",x&&"cursor-not-allowed opacity-40"),children:h})}function P({templates:c,variables:x,urls:l}){var z;const h=C(),[d,o]=b.useState(((z=c==null?void 0:c[0])==null?void 0:z.id)??"new"),i=b.useMemo(()=>c.find(t=>t.id===d),[c,d]),m=d==="new",j=!m&&i&&!i.is_system,g=l.update_post||l.update,v=l.delete_post||l.delete,n=L({name:"",subject:"",body_html:"",is_active:!0});b.useEffect(()=>{i?n.setData({name:i.name||"",subject:i.subject||"",body_html:i.body_html||"",is_active:!!i.is_active}):m&&n.setData({name:"",subject:"",body_html:"<p></p>",is_active:!0})},[i==null?void 0:i.id,m]);const e=A({extensions:[O.configure({heading:{levels:[2,3]}}),M.configure({openOnClick:!1,autolink:!0,defaultProtocol:"https"}),D.configure({placeholder:"Schrijf je e-mail template..."})],content:n.data.body_html||"<p></p>",onUpdate:({editor:t})=>{n.setData("body_html",t.getHTML())}});b.useEffect(()=>{var a;if(!e)return;const t=(a=n.data.body_html)!=null&&a.trim()?n.data.body_html:"<p></p>";e.getHTML()!==t&&e.commands.setContent(t,!1)},[e,n.data.body_html]);const N=(t,a,u={})=>{const w=e?e.getHTML():n.data.body_html;n.transform(p=>({...p,body_html:w})).submit(t,a,{preserveScroll:!0,...u,onSuccess:(...p)=>{var _;S.reload({only:["templates"],preserveScroll:!0,preserveState:!0}),(_=u.onSuccess)==null||_.call(u,...p)}})},y=t=>{var a;(a=t==null?void 0:t.preventDefault)==null||a.call(t),m?N("post",l.store,{onSuccess:()=>o("new")}):i&&N(g?"post":"patch",g.replace("__TEMPLATE__",i.id))},k=async()=>{!i||i.is_system||!await h({title:"Template verwijderen",message:`Weet je zeker dat je "${i.name}" wilt verwijderen?`,confirmText:"Verwijderen",cancelText:"Annuleren",tone:"danger"})||(v?n.post(v.replace("__TEMPLATE__",i.id),{preserveScroll:!0,onSuccess:()=>o("new")}):n.delete(l.delete.replace("__TEMPLATE__",i.id),{preserveScroll:!0,onSuccess:()=>o("new")}))};return s.jsxs("div",{className:"space-y-6",children:[s.jsx(T,{title:"E-mail templates"}),s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-semibold text-zinc-900",children:"E-mail templates"}),s.jsx("p",{className:"mt-1 text-sm text-zinc-500",children:"Beheer je e-mail templates en gebruik variabelen voor persoonlijke velden."})]}),s.jsx(E,{href:l.back||"/dashboard",className:"rounded-md border border-zinc-200 px-3 py-2 text-sm font-semibold hover:bg-zinc-50",children:"Terug"})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-12",children:[s.jsxs("div",{className:"space-y-3 lg:col-span-4",children:[s.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"text-sm font-semibold",children:"Templates"}),s.jsx("button",{type:"button",className:"rounded-full border border-zinc-200 px-3 py-1 text-xs font-semibold hover:bg-zinc-50",onClick:()=>o("new"),children:"Nieuw"})]}),s.jsxs("div",{className:"mt-3 space-y-2",children:[c.length===0&&s.jsx("div",{className:"text-xs text-zinc-500",children:"Nog geen templates."}),c.map(t=>s.jsxs("button",{type:"button",onClick:()=>o(t.id),className:f("w-full rounded-lg border px-3 py-2 text-left transition",d===t.id?"border-zinc-900 bg-zinc-900 text-white":"border-zinc-200 bg-white text-zinc-700 hover:bg-zinc-50"),children:[s.jsx("div",{className:"text-sm font-semibold",children:t.name}),s.jsx("div",{className:f("mt-1 text-xs",d===t.id?"text-zinc-200":"text-zinc-500"),children:t.subject||"Geen onderwerp"})]},t.id))]})]}),s.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-4",children:[s.jsx("div",{className:"text-xs font-semibold text-zinc-500",children:"Beschikbare velden"}),s.jsx("div",{className:"mt-2 space-y-1 text-xs text-zinc-600",children:Object.keys(x||{}).map(t=>s.jsx("div",{className:"rounded-md border border-zinc-200 bg-zinc-50 px-2 py-1 font-mono",children:`{{ ${t} }}`},t))})]})]}),s.jsx("div",{className:"space-y-4 lg:col-span-8",children:s.jsxs("form",{onSubmit:y,className:"space-y-4",children:[s.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-4",children:[s.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold text-zinc-500",children:"Naam"}),s.jsx("input",{className:"mt-2 w-full rounded-md border-zinc-300 text-sm",value:n.data.name,onChange:t=>n.setData("name",t.target.value)}),n.errors.name&&s.jsx("div",{className:"mt-1 text-xs text-rose-600",children:n.errors.name})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold text-zinc-500",children:"Onderwerp"}),s.jsx("input",{className:"mt-2 w-full rounded-md border-zinc-300 text-sm",value:n.data.subject,onChange:t=>n.setData("subject",t.target.value)}),n.errors.subject&&s.jsx("div",{className:"mt-1 text-xs text-rose-600",children:n.errors.subject})]})]}),s.jsxs("label",{className:"mt-4 flex items-center gap-2 text-xs font-semibold text-zinc-600",children:[s.jsx("input",{type:"checkbox",className:"rounded border-zinc-300",checked:!!n.data.is_active,onChange:t=>n.setData("is_active",t.target.checked)}),"Actief"]})]}),s.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-4",children:[s.jsx("div",{className:"text-xs font-semibold text-zinc-500",children:"Template inhoud"}),s.jsxs("div",{className:"mt-2 rounded-lg border border-zinc-200",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-1 border-b border-zinc-100 bg-zinc-50 px-2 py-2",children:[s.jsx(r,{title:"Vet",active:e==null?void 0:e.isActive("bold"),disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().toggleBold().run(),children:"Vet"}),s.jsx(r,{title:"Cursief",active:e==null?void 0:e.isActive("italic"),disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().toggleItalic().run(),children:"Cursief"}),s.jsx(r,{title:"Opsomming",active:e==null?void 0:e.isActive("bulletList"),disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().toggleBulletList().run(),children:"Lijst"}),s.jsx(r,{title:"Genummerde lijst",active:e==null?void 0:e.isActive("orderedList"),disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().toggleOrderedList().run(),children:"Nummering"}),s.jsx(r,{title:"Link",active:e==null?void 0:e.isActive("link"),disabled:!e,onClick:()=>{if(!e)return;const t=e.getAttributes("link").href||"",a=window.prompt("Link URL",t);if(a!==null){if(a===""){e.chain().focus().unsetLink().run();return}e.chain().focus().extendMarkRange("link").setLink({href:a}).run()}},children:"Link"}),s.jsx(r,{title:"Opmaak wissen",disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().clearNodes().unsetAllMarks().run(),children:"Wissen"}),s.jsx(r,{title:"Ongedaan maken",disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().undo().run(),children:"Undo"}),s.jsx(r,{title:"Opnieuw",disabled:!e,onClick:()=>e==null?void 0:e.chain().focus().redo().run(),children:"Redo"})]}),s.jsx(H,{editor:e,className:"tiptap px-3 py-2 text-sm"})]})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("button",{type:"button",className:"rounded-md bg-zinc-900 px-3 py-2 text-sm font-semibold text-white hover:bg-zinc-800 disabled:opacity-60",disabled:n.processing,onClick:y,children:n.processing?"Opslaan...":"Opslaan"}),j&&s.jsx("button",{type:"button",className:"rounded-md border border-rose-200 px-3 py-2 text-sm font-semibold text-rose-600 hover:bg-rose-50",onClick:k,children:"Verwijderen"}),!j&&!m&&i&&i.is_system&&s.jsx("div",{className:"text-xs text-zinc-500",children:"Standaard templates kun je niet verwijderen."})]})]})})]})]})}export{P as default};
