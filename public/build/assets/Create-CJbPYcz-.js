import{u as w,r as k,j as e,H as y,L as p}from"./app-D9pQ-r5n.js";import"./app-Da9Q4cYH.js";function h(r){try{return new Intl.NumberFormat("nl-NL",{style:"currency",currency:"EUR"}).format(r??0)}catch{return`EUR ${Number(r??0).toFixed(2)}`.replace(".",",")}}function N(r){const i=Number(String(r).replace(",","."));return Number.isFinite(i)?i:0}function M({statusOptions:r,sourceOptions:i,moduleRows:f,defaults:b,urls:u}){const{data:a,setData:n,post:g,processing:j,errors:t}=w({bedrijfsnaam:"",land:b.land||"Nederland",voor_en_achternaam:"",email:"",telefoonnummer:"",straatnaam_en_nummer:"",postcode:"",plaats:"",iban:"",bic:"",plaats_van_tekenen:"",datum_van_tekenen:b.datum_van_tekenen||"",status:(r==null?void 0:r[0])||"lead",bron:(i==null?void 0:i[0])||"website_formulier",tags:"",moduleRows:f||[]}),m=k.useMemo(()=>{let s=0,l=0,d=0;return a.moduleRows.forEach(c=>{if(!c.actief)return;const x=N(c.prijs_maand_excl),v=Math.max(1,Number(c.aantal||1));s+=x*v,l+=x*v*(N(c.btw_percentage)/100),d+=1}),{totaleModules:a.moduleRows.length,actieveModules:d,totaalExcl:s,btw:l,totaalIncl:s+l}},[a.moduleRows]),o=(s,l,d)=>{n("moduleRows",a.moduleRows.map((c,x)=>x===s?{...c,[l]:d}:c))},z=s=>{const l=a.moduleRows[s];o(s,"actief",!l.actief),!l.actief&&Number(l.aantal||0)<1&&o(s,"aantal",1)},_=s=>{s.preventDefault(),g(u.store,{preserveScroll:!0})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(y,{title:"Nieuwe klant"}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-zinc-900",children:"Nieuwe klant"}),e.jsx("p",{className:"mt-1 text-sm text-zinc-500",children:"Maak een garagebedrijf aan met modules en incasso."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{href:u.index,className:"rounded-md border border-zinc-200 px-3 py-2 text-sm font-semibold hover:bg-zinc-50",children:"Terug"}),e.jsx(p,{href:u.old_create,className:"rounded-md border border-zinc-200 px-3 py-2 text-sm font-semibold text-zinc-500 hover:bg-zinc-50",children:"Nieuw (old)"})]})]}),e.jsxs("form",{onSubmit:_,className:"space-y-6",children:[e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-5",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Bedrijf"}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Bedrijfsnaam *"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.bedrijfsnaam,onChange:s=>n("bedrijfsnaam",s.target.value)}),t.bedrijfsnaam&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:t.bedrijfsnaam})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Land *"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.land,onChange:s=>n("land",s.target.value)})]})]})]}),e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-5",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Contactpersoon"}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Voor- en achternaam *"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.voor_en_achternaam,onChange:s=>n("voor_en_achternaam",s.target.value)}),t.voor_en_achternaam&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:t.voor_en_achternaam})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"E-mail *"}),e.jsx("input",{type:"email",className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.email,onChange:s=>n("email",s.target.value)}),t.email&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:t.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Telefoon *"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.telefoonnummer,onChange:s=>n("telefoonnummer",s.target.value)}),t.telefoonnummer&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:t.telefoonnummer})]})]})]}),e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-5",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Adres"}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Straat + nummer *"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.straatnaam_en_nummer,onChange:s=>n("straatnaam_en_nummer",s.target.value)}),t.straatnaam_en_nummer&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:t.straatnaam_en_nummer})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Postcode *"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.postcode,onChange:s=>n("postcode",s.target.value)}),t.postcode&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:t.postcode})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Plaats *"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.plaats,onChange:s=>{n("plaats",s.target.value),a.plaats_van_tekenen||n("plaats_van_tekenen",s.target.value)}}),t.plaats&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:t.plaats})]})]})]}),e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-5",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Incasso (SEPA)"}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"IBAN *"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.iban,onChange:s=>n("iban",s.target.value)}),t.iban&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:t.iban})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"BIC"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.bic,onChange:s=>n("bic",s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Plaats van tekenen *"}),e.jsx("input",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.plaats_van_tekenen,onChange:s=>n("plaats_van_tekenen",s.target.value)}),t.plaats_van_tekenen&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:t.plaats_van_tekenen})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Datum van tekenen *"}),e.jsx("input",{type:"date",className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.datum_van_tekenen,onChange:s=>n("datum_van_tekenen",s.target.value)}),t.datum_van_tekenen&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:t.datum_van_tekenen})]})]})]}),e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-5",children:[e.jsx("div",{className:"text-sm font-semibold",children:"CRM"}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Status"}),e.jsx("select",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.status,onChange:s=>n("status",s.target.value),children:r.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Bron"}),e.jsx("select",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",value:a.bron,onChange:s=>n("bron",s.target.value),children:i.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600",children:"Tags"}),e.jsx("textarea",{className:"mt-1 w-full rounded-md border-zinc-300 text-sm",rows:2,value:a.tags,onChange:s=>n("tags",s.target.value)})]})]})]}),e.jsxs("div",{className:"space-y-4 rounded-xl border border-zinc-200 bg-white p-5",children:[e.jsx("div",{className:"flex flex-wrap items-center justify-between gap-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold",children:"Modules & prijzen"}),e.jsxs("div",{className:"mt-1 text-xs text-zinc-500",children:["Activeer modules en leg prijsafspraken vast per maand. Actief: ",m.actieveModules," /"," ",m.totaleModules,". Actief vereist aantal â‰¥ 1. Prijs 0 is toegestaan."]})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-zinc-50 p-4",children:[e.jsx("div",{className:"text-xs font-medium text-zinc-500",children:"Totaal excl. btw"}),e.jsx("div",{className:"mt-1 text-xl font-semibold",children:h(m.totaalExcl)})]}),e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-zinc-50 p-4",children:[e.jsx("div",{className:"text-xs font-medium text-zinc-500",children:"BTW bedrag"}),e.jsx("div",{className:"mt-1 text-xl font-semibold",children:h(m.btw)})]}),e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-zinc-50 p-4",children:[e.jsx("div",{className:"text-xs font-medium text-zinc-500",children:"Totaal incl. btw"}),e.jsx("div",{className:"mt-1 text-xl font-semibold",children:h(m.totaalIncl)})]})]}),e.jsx("div",{className:"overflow-hidden rounded-xl border border-zinc-200 bg-white",children:e.jsxs("table",{className:"min-w-full divide-y divide-zinc-100",children:[e.jsx("thead",{className:"bg-zinc-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-zinc-600",children:"Actief"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-zinc-600",children:"Module"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-zinc-600",children:"Aantal"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-zinc-600",children:"Prijs (excl.)"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-zinc-600",children:"BTW %"})]})}),e.jsx("tbody",{className:"divide-y divide-zinc-100",children:a.moduleRows.map((s,l)=>e.jsxs("tr",{className:"hover:bg-zinc-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"checkbox",className:"rounded border-zinc-300",checked:s.actief,onChange:()=>z(l)})}),e.jsx("td",{className:"px-4 py-3 text-sm font-semibold",children:s.naam}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("input",{type:"number",min:"0",max:"999",className:"w-24 rounded-md border-zinc-300 text-sm",value:s.aantal,onChange:d=>o(l,"aantal",d.target.value)}),t[`moduleRows.${l}.aantal`]&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:t[`moduleRows.${l}.aantal`]})]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("input",{type:"number",step:"0.01",min:"0",className:"w-40 rounded-md border-zinc-300 text-sm",value:s.prijs_maand_excl,onChange:d=>o(l,"prijs_maand_excl",d.target.value)}),t[`moduleRows.${l}.prijs_maand_excl`]&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:t[`moduleRows.${l}.prijs_maand_excl`]})]}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",className:"w-24 rounded-md border-zinc-300 text-sm",value:s.btw_percentage,onChange:d=>o(l,"btw_percentage",d.target.value)}),t[`moduleRows.${l}.btw_percentage`]&&e.jsx("div",{className:"mt-1 text-xs text-rose-600",children:t[`moduleRows.${l}.btw_percentage`]})]})]},s.module_id))})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",className:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white hover:bg-indigo-700",disabled:j,children:j?"Opslaan...":"Klant opslaan"})})]})]})}export{M as default};
